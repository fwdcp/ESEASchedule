<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-ajax/core-ajax.html">
<link rel="import" href="eseaschedule-controls.html">
<link rel="import" href="eseaschedule-matches.html">

<polymer-element name="eseaschedule-main">
    <template>
        <link rel="stylesheet" href="../bower_components/materialize/dist/css/materialize.min.css">

        <eseaschedule-controls startDate="{{startDate}}" endDate="{{endDate}}"></eseaschedule-controls>
        <eseaschedule-matches id="matches"></eseaschedule-matches>

        <core-ajax
        url="/matches/{{startDate | dateValueFormatter}}/{{endDate | dateValueFormatter}}/list.json"
        handleAs="json"
        auto
        on-core-response="{{getMatches}}"></core-ajax>
    </template>

    <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment.min.js"></script>

    <script>
    Polymer({
        "matches": [],
        "dateValueFormatter": function(value) {
            return moment(value).format("YYYY-MM-DD");
        },
        "getMatches": function(event, detail, sender) {
            if (sender.response) {
                this.$.matches.matches = sender.response;
            }
        }
    });
    </script>
</polymer-element>
